data("iris")
data("cars")
head(cars)
data("vehicle")
data("mtcars")
head(mtcars)
pairs(cars)
pairs(mtcars)
pairs(mtcars[,-c(2,8:11)])
results<-lm(mpg~disp+hp+drat+wt,data=mtcars)
summary(results)
results2<-lm(mpg~hp+wt,data=mtcars)
summary(results2)
anova(results,results2)
predict(results2,data.frame(hp=100,wt=1000), interval="confidence")
rm(result,results2)
rm(result2,results2)
rm(results)
head(mtcars)
head(mtcars)
ind<-sample(2,nrow(mtcars),replace = TRUE, prob = c(0.8,0.2))
train_data<-mtcars[ind==1,]
valid_data<-mtcars[ind==2,]
head(train_data,3)
head(valid_data,3)
head(train_data,3)
results<-lm(mpg~hp+wt,mtcars)
summary(results)
results$coefficients
coef(results)
pred<-predict(results,valid_data)
head(pred,3)
head(valid_data,3)
anova(pred,valid_data$mpg)
str(valid_data)
mpg2<-as.double(valid_data$mpg)
anova(pred,mpg2)
aov(pred,mpg2)
rm<-mpg2
mpg2<-valid_data$mpg
dat<-cbind(pred,valid_data$mpg)
aov(mpg~mpg2,data = dat)
dat<-data.frame(dat)
aov(mpg~mpg2,data = dat)
str(dat)
dat<-data.frame(dat,colnames("pred","mpg"))
name(dat)[2]<-"mpg"
names(dat)[2]<-"mpg"
aov(pred~mpg,data = dat)
str(dat)
anova(dat[1:2])
aov(pred~mpg,data = dat)
plot(pred,mpg)
plot(pred,mpg,data=dat)
str(dat)
plot(pred,dat$mpg)
plot(dat$mpg,pred)
aov(mpg~pred,data = dat)
plot(dat$mpg,pred)
rm(list=ls(all=TRUE))
install.packages("faraway")
require(faraway)
data("divusa")
str(divusa)
head(divusa,3)
head(divusa)
str(divusa)
?divusa
mydata<-data.frame(divusa[,-1]])
mydata<-data.frame(divusa[,-1])
head(mydata)
round(cor(mydata),2)
rm(list=ls(all=TRUE))
data("divusa")
head(divusa)
mydata<-data.frame(divusa[,-1])
head(mydata)
round(cor(mydata),2)
mod<-lm(divorce~.,mydata)
mod
rm(list=ls(all=TRUE))
data("divusa")
head(divusa)
mydata<-data.frame(divusa[,-1])
head(mydata)
round(cor(mydata),2)
mod<-lm(divorce~.,mydata)
mod
summary(mod)
vif(mod)
mod2<-lm(divorce~femlab+marriage+birth,mydata)
summary(mod2)
vif(mod2)
rm(list=ls(all=TRUE))
mydata<-read.csv("http://www.ats.ucla.edu/stat/data/binary.csv",header = TRUE)
head(mydata,2)
str(mydata)
install.packages("aod")
library(aod)
library(ggplot2)
library(Rcpp)
rm(list=ls(all=TRUE))
mydata<-read.csv("http://www.ats.ucla.edu/stat/data/binary.csv",header = TRUE)
head(mydata,2)
summary(mydata)
sapply(mydata,sd)
xtabs(~admit+rank,data=mydata)
mydata$rank<-factor(mydata$rank)
mylogit<-glm(admit~gre+gpa+rank,data = mydata, family = "binomial")
summary(mylogit)
head(mydata)
confint(mylogit)
confint.default(mylogit)
wald.test(b = coef(mylogit), Sigma = vcov(mylogit), Terms = 4:6)
vcov(mylogit)
l <- cbind(0,0,0,1,-1,0)
wald.test(b = coef(mylogit), Sigma = vcov(mylogit), L = l)
exp(coef(mylogit))
exp(cbind(OR = coef(mylogit), confint(mylogit)))
newdata1 <- with(mydata,data.frame(gre = mean(gre), gpa = mean(gpa), rank = factor(1:4)))
newdata1
newdata1$rankP <- predict(mylogit, newdata = newdata1, type = "response")
newdata1
round(newdata1,2)
newdata2 <- with(mydata,data.frame(gre = rep(seq(from = 200, to = 800, length.out = 100), 4),gpa = mean(gpa), rank = factor(rep(1:4, each = 100))))
newdata3 <- cbind(newdata2, predict(mylogit, newdata = newdata2, type="link", se=TRUE))
newdata3 <- within(newdata3, {PredictedProb <- plogis(fit) LL <- plogis(fit - (1.96 * se.fit)) UL <- plogis(fit + (1.96 * se.fit))})
newdata3 <- within(newdata3, {
PredictedProb <- plogis(fit)
LL <- plogis(fit - (1.96 * se.fit))
UL <- plogis(fit + (1.96 * se.fit))
})
head(newdata3)
ggplot(newdata3, aes(x = gre, y = PredictedProb)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = rank), alpha = .2) +
geom_line(aes(colour = rank), size=1)
ggplot(newdata3, aes(x = gre, y = PredictedProb)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = rank), alpha = .2) +
geom_line(aes(colour = rank), size=1)
with(mylogit, null.deviance - deviance)
with(mylogit, df.null - df.residual)
with(mylogit, pchisq(null.deviance - deviance, df.null - df.residual, lower.tail = FALSE))
logLik(mylogit)
setwd("/home/ben/Documentos/ben/Documentos/OPI/2.A/Files")
files = list.files(pattern="*.csv")
myfiles = do.call(rbind, lapply(files, function(x) read.csv(x)))
str(myfiles)
head(myfiles)
rm(list=ls(all=TRUE))
files = list.files(pattern="*.csv")
ecobici = do.call(rbind, lapply(files, function(x) read.csv(x)))
str(ecobici)
head(ecobici,20)
str(ecobici)
ecobici$Hora_Retiro<-as.Date(ecobici$Hora_Retiro,format=%h)
ecobici$Hora_Retiro<-factor(format(as.Date(ecobici$Hora_Retiro,format='%h')))
str(ecobici)
rm
rm(list=ls(all=TRUE))
bicioct<-read.csv("Files/2016-10.csv",header = TRUE,sep = ",")
setwd("/home/ben/Documentos/ben/Documentos/OPI/2.A")
bicioct<-read.csv("Files/2016-10.csv",header = TRUE,sep = ",")
str(bicioct)
bicioct$Hora_Retiro<-as.Date(bicioct$Hora_Retiro,format="%h")
head(bicioct,20)
rm(list=ls(all=TRUE))
bicioct<-read.csv("Files/2016-10.csv",header = TRUE,sep = ",",stringsAsFactors = FALSE)
head(bicioct,10)
bicioct$Hora_Retiro<-as.Date(bicioct$Hora_Retiro,format = '%h')
head(bicioct,10)
rm(list=ls(all=TRUE))
rm(list=ls(all=TRUE))
bicioct$Hora_Retiro<-as.Date(bicioct$Hora_Retiro,format = '%h:%m:%s')
bicioct<-read.csv("Files/2016-10.csv",header = TRUE,sep = ",",stringsAsFactors = FALSE)
bicioct$Hora_Retiro<-as.Date(bicioct$Hora_Retiro,format = '%h:%m:%s')
head(bicioct)
rm(list=ls(all=TRUE))
bicioct<-read.csv("Files/2016-10.csv",header = TRUE,sep = ",",stringsAsFactors = FALSE)
str(bicioct)
caden<-gsub<("AM","",bicioct$Hora_Retiro)
cadena<-gsub("AM","", bicioct$Hora_Retiro)
head(cadena)
rm(cadena)
cadena<-gsub("\\s AM","", bicioct$Hora_Retiro)
rm(cadena)
cadena<-gsub("\\s AM","", bicioct$Hora_Retiro)
rm(cadena)
cadena<-gsub("\\s AM","", bicioct$Hora_Retiro)
head(cadena)
cadena<-gsub(" AM","", bicioct$Hora_Retiro)
head(cadena)
bicioct$Hora_Retiro<-gsub(" AM","", bicioct$Hora_Retiro)
bicioct$Hora_Retiro<-gsub(" PM","", bicioct$Hora_Retiro)
head(bicioct,100)
bicioct$Hora_Retiro<-as.Date(bicioct$Hora_Retiro,format = '%h')
bicioct$Hora_Retiro<-as.Date(bicioct$Hora_Retiro,format = '%h:%m:%s')
head(bicioct,100)
rm(list=ls(all=TRUE))
bicioct<-read.csv("Files/2016-10.csv",header = TRUE,sep = ",",stringsAsFactors = FALSE)
bicioct$Hora_Retiro<-gsub(" AM","", bicioct$Hora_Retiro)
bicioct$Hora_Retiro<-gsub(" PM","", bicioct$Hora_Retiro)
str(bicioct)
head(bicioct)
rm(list=ls(all=TRUE))
setwd("/home/ben/Documentos/ben/Documentos/OPI/2.A")
bicioct<-read.csv("Files/2016-10.csv",header = TRUE,sep = ",",stringsAsFactors = FALSE)
str(bicioct)
bicioct$Hora_Retiro[1:2]
bicioct$Hora_Retiro[1:2][1:2]
substr(bicioct$Hora_Retiro[1:2][1],1,2)
bicioct$Hora_Retiro<-gsub(" AM","", bicioct$Hora_Retiro)
str(bicioct)
head(bicioct)
bicioct$Hora_Retiro<-ifelse(substr(bicioct$Hora_Retiro=="12"),"12","NA")
bicioct$Hora_Retiro<-ifelse(substr(bicioct$Hora_Retiro,1,2)=="12","12","NA")
str(bicioct)
bicioct$Hora_Retiro<-factor(bicioct$Hora_Retiro)
str(bicioct)
table(bicioct$Hora_Retiro)
substr(bicioct$Hora_Retiro[1],1,1)
rm(list=ls(all=TRUE))
bicioct$Ciclo_Estacion_Retiro<-factor(bicioct$Ciclo_Estacion_Retiro)
bicioct<-read.csv("Files/2016-10.csv",header = TRUE,sep = ",",stringsAsFactors = FALSE)
bicioct$Hora_Retiro<-ifelse(substr(bicioct$Hora_Retiro,1,2)=="12","12",ifelse(substr(bicioct$Hora_Retiro,1,1)=="1","1","NA"))
table(bicioct$Hora_Retiro)
rm(list=ls(all=TRUE))
bicioct<-read.csv("Files/2016-10.csv",header = TRUE,sep = ",",stringsAsFactors = FALSE)
bicioct$Hora_Retiro<-ifelse(substr(bicioct$Hora_Retiro,1,2)=="12","12",ifelse(substr(bicioct$Hora_Retiro,1,2)=="11","11",ifelse(substr(bicioct$Hora_Retiro,1,2)=="10","10",ifelse(substr(bicioct$Hora_Retiro,1,1)=="9","9",ifelse(substr(bicioct$Hora_Retiro,1,1)=="8","8",ifelse(substr(bicioct$Hora_Retiro,1,1)=="7","7",ifelse(substr(bicioct$Hora_Retiro,1,1)=="6","6","NA")))))))
bicioct$Hora_Retiro<-factor(bicioct$Hora_Retiro)
table(bicioct$Hora_Retiro)
rm(list=ls(all=TRUE))
bicioct<-read.csv("Files/2016-10.csv",header = TRUE,sep = ",",stringsAsFactors = FALSE)
tabla<-ifelse(substr(bicioct$Hora_Retiro,10,11)=="PM",TRUE,FALSE)
table(tabla)
bicioct$Hora_Retiro<-ifelse(substr(bicioct$Hora_Retiro,1,2)=="12","12",ifelse(substr(bicioct$Hora_Retiro,1,2)=="11","11",ifelse(substr(bicioct$Hora_Retiro,1,2)=="10","10",ifelse(substr(bicioct$Hora_Retiro,1,1)=="9","9",ifelse(substr(bicioct$Hora_Retiro,1,1)=="8","8",ifelse(substr(bicioct$Hora_Retiro,1,1)=="7","7",ifelse(substr(bicioct$Hora_Retiro,1,1)=="6","6",ifelse(substr(bicioct$Hora_Retiro,1,1)=="5","5",ifelse(substr(bicioct$Hora_Retiro,1,1)=="4","4",ifelse(substr(bicioct$Hora_Retiro,1,1)=="3","3",ifelse(substr(bicioct$Hora_Retiro,1,1)=="2","2",ifelse(substr(bicioct$Hora_Retiro,1,1)=="1","1","NA"))))))))))))
bicioct$Hora_Retiro<-factor(bicioct$Hora_Retiro)
table(bicioct$Hora_Retiro)
rm(list=ls(all=TRUE))
bicioct<-read.csv("Files/2016-10.csv",header = TRUE,sep = ",",stringsAsFactors = FALSE)
tabla<-ifelse(substr(bicioct$Hora_Retiro,10,11)=="PM",TRUE,FALSE)
table(tabla)
bicioct2<-bicioct
bicioct2$Hora_Retiro<-ifelse(substr(bicioct$Hora_Retiro,1,2)=="12" & substr(bicioct$Hora_Retiro,10,11)=="AM","12",ifelse(substr(bicioct$Hora_Retiro,1,2)=="11" & substr(bicioct$Hora_Retiro,10,11)=="AM","11",ifelse(substr(bicioct$Hora_Retiro,1,2)=="10"&substr(bicioct$Hora_Retiro,10,11)=="AM","10",ifelse(substr(bicioct$Hora_Retiro,1,1)=="9"&substr(bicioct$Hora_Retiro,10,11)=="AM","9",ifelse(substr(bicioct$Hora_Retiro,1,1)=="8"&substr(bicioct$Hora_Retiro,10,11)=="AM","8",ifelse(substr(bicioct$Hora_Retiro,1,1)=="7"&substr(bicioct$Hora_Retiro,10,11)=="AM","7",ifelse(substr(bicioct$Hora_Retiro,1,1)=="6"&substr(bicioct$Hora_Retiro,10,11)=="AM","6",ifelse(substr(bicioct$Hora_Retiro,1,1)=="5"&substr(bicioct$Hora_Retiro,10,11)=="AM","5",ifelse(substr(bicioct$Hora_Retiro,1,1)=="4"&substr(bicioct$Hora_Retiro,10,11)=="AM","4",ifelse(substr(bicioct$Hora_Retiro,1,1)=="3","3",ifelse(substr(bicioct$Hora_Retiro,1,1)=="2","2",ifelse(substr(bicioct$Hora_Retiro,1,1)=="1","1","NA"))))))))))))
bicioct2$Hora_Retiro<-factor(bicioct$Hora_Retiro)
table(bicioct$Hora_Retiro)
bicioct2<-bicioct
bicioct2<-bicioct
bicioct2$Hora_Retiro<-ifelse(substr(bicioct$Hora_Retiro,1,2)=="12" & substr(bicioct$Hora_Retiro,10,11)=="AM","12",ifelse(substr(bicioct$Hora_Retiro,1,2)=="11" & substr(bicioct$Hora_Retiro,10,11)=="AM","11",ifelse(substr(bicioct$Hora_Retiro,1,2)=="10"&substr(bicioct$Hora_Retiro,10,11)=="AM","10",ifelse(substr(bicioct$Hora_Retiro,1,1)=="9"&substr(bicioct$Hora_Retiro,9,10)=="AM","9",ifelse(substr(bicioct$Hora_Retiro,1,1)=="8"&substr(bicioct$Hora_Retiro,9,10)=="AM","8",ifelse(substr(bicioct$Hora_Retiro,1,1)=="7"&substr(bicioct$Hora_Retiro,9,10)=="AM","7",ifelse(substr(bicioct$Hora_Retiro,1,1)=="6"&substr(bicioct$Hora_Retiro,9,10)=="AM","6",ifelse(substr(bicioct$Hora_Retiro,1,1)=="5"&substr(bicioct$Hora_Retiro,9,10)=="AM","5",ifelse(substr(bicioct$Hora_Retiro,1,1)=="4"&substr(bicioct$Hora_Retiro,9,10)=="AM","4",ifelse(substr(bicioct$Hora_Retiro,1,1)=="3"&substr(bicioct$Hora_Retiro,9,10)=="AM","3",ifelse(substr(bicioct$Hora_Retiro,1,1)=="2"&substr(bicioct$Hora_Retiro,9,10)=="AM","2",ifelse(substr(bicioct$Hora_Retiro,1,1)=="1"&substr(bicioct$Hora_Retiro,9,10)=="AM","1","NA"))))))))))))
table(bicioct$Hora_Retiro)
tabla2<-ifelse(substr(bicioct$Hora_Retiro,1,2)=="12" && substr(bicioct$Hora_Retiro,10,11)=="PM",TRUE,FALSE)
tabla2<-ifelse(substr(bicioct$Hora_Retiro,1,2)=="12" & substr(bicioct$Hora_Retiro,10,11)=="PM",TRUE,FALSE)
table(tabla2)
tabla3<-ifelse(substr(bicioct$Hora_Retiro,1,2)=="12" & substr(bicioct$Hora_Retiro,10,11)=="AM",TRUE,FALSE)
table(tabla3)
tabla<-ifelse(substr(bicioct$Hora_Retiro,10,11)=="PM",TRUE,FALSE)
table(tabla)
rm(list=ls(all=TRUE))
bicioct<-read.csv("Files/2016-10.csv",header = TRUE,sep = ",",stringsAsFactors = FALSE)
bicioct$Hora_Retiro<-gsub(" AM","", bicioct$Hora_Retiro)
bicioct$Hora_Retiro<-gsub(" PM","", bicioct$Hora_Retiro)
bicioct<-read.csv("Files/2016-10.csv",header = TRUE,sep = ",",stringsAsFactors = FALSE)
bicioct2$Hora_Retiro<-gsub(" AM","", bicioct$Hora_Retiro)
bicioct2<-bicioct
bicioct2$Hora_Retiro<-gsub(" AM","", bicioct$Hora_Retiro)
bicioct2$Hora_Retiro<-gsub(" PM","", bicioct$Hora_Retiro)
bicioct$Hora_Retiro<-as.Date(bicioct$Hora_Retiro,format = '%h')
rm(list=ls(all=TRUE))
bicioct<-read.csv("Files/2016-10.csv",header = TRUE,sep = ",",stringsAsFactors = FALSE)
bicioct2<-bicioct
bicioct2$Hora_Retiro<-gsub(" AM","", bicioct$Hora_Retiro)
bicioct2$Hora_Retiro<-gsub(" PM","", bicioct$Hora_Retiro)
bicioct2$Hora_Retiro<-as.Date(bicioct$Hora_Retiro,format = '%h:%m:%s')
head(bicioct2)
head(bicioct)
bicioct2$Hora_Retiro<-as.numeric(bicioct$Hora_Retiro)
bicioct2<-bicioct
bicioct2$Hora_Retiro<-gsub(" AM","", bicioct$Hora_Retiro)
bicioct2$Hora_Retiro<-gsub(" PM","", bicioct$Hora_Retiro)
bicioct2$Hora_Retiro<-as.numeric(bicioct2$Hora_Retiro)
bicioct2<-bicioct
bicioct2$Hora_Retiro<-gsub(" AM","", bicioct$Hora_Retiro)
bicioct2$Hora_Retiro<-gsub(":","", bicioct$Hora_Retiro)
bicioct2$Hora_Retiro<-gsub(" PM","", bicioct$Hora_Retiro)
bicioct2$Hora_Retiro<-as.numeric(bicioct2$Hora_Retiro)
head(bicioct2)
bicioct2<-bicioct
#borrar el am
bicioct2$Hora_Retiro<-gsub(" AM","", bicioct$Hora_Retiro)
bicioct2$Hora_Retiro<-gsub(":","", bicioct$Hora_Retiro)
bicioct2$Hora_Retiro<-gsub(" PM","", bicioct$Hora_Retiro)
head(bicioct2)
bicioct2<-bicioct
bicioct2$Hora_Retiro<-gsub(" AM","", bicioct2$Hora_Retiro)
bicioct2$Hora_Retiro<-gsub(":","", bicioct2$Hora_Retiro)
bicioct2$Hora_Retiro<-gsub(" PM","", bicioct2$Hora_Retiro)
bicioct2$Hora_Retiro<-gsub(" AM","", bicioct2$Hora_Retiro)
bicioct2$Hora_Retiro<-gsub(":","", bicioct2$Hora_Retiro)
bicioct2$Hora_Retiro<-gsub(" PM","", bicioct2$Hora_Retiro)
head(bicioct2)
bicioct2$Hora_Retiro<-as.numeric(bicioct2$Hora_Retiro)
bicioct2$Hora_Retiro<-as.double(bicioct2$Hora_Retiro)
head(bicioct2)
head(bicioct)
tabla<-ifelse(substr(bicioct$Hora_Retiro,10,11)=="PM",as.double(substr(bicioct$Hora_Retiro,1,2))+12,0)
tabla<-ifelse(substr(bicioct$Hora_Retiro,10,11)=="PM",TRUE,FALSE)
tabla<-ifelse(substr(bicioct$Hora_Retiro,10,11)=="PM",as.double(substr(bicioct$Hora_Retiro,1,2))+12,0)
table(tabla)
tabla<-ifelse(substr(bicioct$Hora_Retiro,10,11)=="PM",as.double(substr(bicioct$Hora_Retiro,1,2))+12,as.double(substr(bicioct$Hora_Retiro,1,2)))
table(tabla)
head(tabla,100)
head(tabla,1000)
head(tabla,1500)
rm(list=ls(all=TRUE))
setwd("/home/ben/Documentos/ben/Documentos/OPI/Problemas resueltos/2.A/Files")
files = list.files(pattern="*.csv")
ecobici = do.call(rbind, lapply(files, function(x) read.csv(x,sep = ";",stringsAsFactors = FALSE)))
ecobici2<-ecobici
ecobici2$Fecha_Retiro<-as.Date(ecobici2$Fecha_Retiro,format = '%d/%m/%Y')
ecobici2$Fecha_Arribo<-as.Date(ecobici2$Fecha_Arribo,format = '%d/%m/%Y')
ecobici2$Genero_Usuario<-factor(ecobici2$Genero_Usuario)
ecobici2$Fecha_Retiro<-factor(ecobici2$Fecha_Retiro)
ecobici2$Ciclo_Estacion_Retiro<-factor(ecobici2$Ciclo_Estacion_Retiro)
ecobici2$Ciclo_Estacion_Arribo<-factor(ecobici2$Ciclo_Estacion_Arribo)
ecobici2$Hora_Arribo<-factor(ecobici2$Hora_Arribo)
afluencia2<-table(estaciones=ecobici2$Ciclo_Estacion_Retiro, Horario=ecobici2$Hora_Retiro)
write.csv(afluencia2,"afluencia.csv")
afluencia<-read.csv("afluencia.csv",header = TRUE,row.names = 1)
names(afluencia)[1:21]<-c("H0","H1","H5","H6","H7","H8","H9","H10","H11","H12","H13","H14","H15","H16","H17","H18","H19","H20","H21","H22","H23")
estaciones<-rowMeans(afluencia)
estaciones<-sort(estaciones,decreasing = TRUE)
head(estaciones,50)
clasificacion<-ifelse(estaciones<1242 & estaciones>320, "Muy alto",ifelse(estaciones<=320 & estaciones>238,"Alto",ifelse(estaciones<=238 & estaciones>190,"Media",ifelse(estaciones<=190 & estaciones>180,"Bajo","Muy Bajo"))))
pie(table(clasificacion),main="Clasificacion inventada por mi")
install.packages("plotrix")
kmodel<-kmeans(afluencia,6,iter.max = 100)
kmodel
require(plotrix)
lbls <- c("Exesiva", "Muy Alta", "Alta", "Media", "Baja","Muy baja")
pie3D(table(kmodel$cluster),labels=lbls,explode=0.1, main="K-means Class ")
pie3D(table(kmodel$cluster),labels=lbls,explode=0.1, col=kmodel$cluster,main="K-means Class ")
pie3D(table(clasificacion),main="Clasificacion inventada por mi")
