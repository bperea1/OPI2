data("iris")
data("cars")
head(cars)
data("vehicle")
data("mtcars")
head(mtcars)
pairs(cars)
pairs(mtcars)
pairs(mtcars[,-c(2,8:11)])
results<-lm(mpg~disp+hp+drat+wt,data=mtcars)
summary(results)
results2<-lm(mpg~hp+wt,data=mtcars)
summary(results2)
anova(results,results2)
predict(results2,data.frame(hp=100,wt=1000), interval="confidence")
rm(result,results2)
rm(result2,results2)
rm(results)
head(mtcars)
head(mtcars)
ind<-sample(2,nrow(mtcars),replace = TRUE, prob = c(0.8,0.2))
train_data<-mtcars[ind==1,]
valid_data<-mtcars[ind==2,]
head(train_data,3)
head(valid_data,3)
head(train_data,3)
results<-lm(mpg~hp+wt,mtcars)
summary(results)
results$coefficients
coef(results)
pred<-predict(results,valid_data)
head(pred,3)
head(valid_data,3)
anova(pred,valid_data$mpg)
str(valid_data)
mpg2<-as.double(valid_data$mpg)
anova(pred,mpg2)
aov(pred,mpg2)
rm<-mpg2
mpg2<-valid_data$mpg
dat<-cbind(pred,valid_data$mpg)
aov(mpg~mpg2,data = dat)
dat<-data.frame(dat)
aov(mpg~mpg2,data = dat)
str(dat)
dat<-data.frame(dat,colnames("pred","mpg"))
name(dat)[2]<-"mpg"
names(dat)[2]<-"mpg"
aov(pred~mpg,data = dat)
str(dat)
anova(dat[1:2])
aov(pred~mpg,data = dat)
plot(pred,mpg)
plot(pred,mpg,data=dat)
str(dat)
plot(pred,dat$mpg)
plot(dat$mpg,pred)
aov(mpg~pred,data = dat)
plot(dat$mpg,pred)
rm(list=ls(all=TRUE))
install.packages("faraway")
require(faraway)
data("divusa")
str(divusa)
head(divusa,3)
head(divusa)
str(divusa)
?divusa
mydata<-data.frame(divusa[,-1]])
mydata<-data.frame(divusa[,-1])
head(mydata)
round(cor(mydata),2)
rm(list=ls(all=TRUE))
data("divusa")
head(divusa)
mydata<-data.frame(divusa[,-1])
head(mydata)
round(cor(mydata),2)
mod<-lm(divorce~.,mydata)
mod
rm(list=ls(all=TRUE))
data("divusa")
head(divusa)
mydata<-data.frame(divusa[,-1])
head(mydata)
round(cor(mydata),2)
mod<-lm(divorce~.,mydata)
mod
summary(mod)
vif(mod)
mod2<-lm(divorce~femlab+marriage+birth,mydata)
summary(mod2)
vif(mod2)
rm(list=ls(all=TRUE))
mydata<-read.csv("http://www.ats.ucla.edu/stat/data/binary.csv",header = TRUE)
head(mydata,2)
str(mydata)
install.packages("aod")
library(aod)
library(ggplot2)
library(Rcpp)
rm(list=ls(all=TRUE))
mydata<-read.csv("http://www.ats.ucla.edu/stat/data/binary.csv",header = TRUE)
head(mydata,2)
summary(mydata)
sapply(mydata,sd)
xtabs(~admit+rank,data=mydata)
mydata$rank<-factor(mydata$rank)
mylogit<-glm(admit~gre+gpa+rank,data = mydata, family = "binomial")
summary(mylogit)
head(mydata)
confint(mylogit)
confint.default(mylogit)
wald.test(b = coef(mylogit), Sigma = vcov(mylogit), Terms = 4:6)
vcov(mylogit)
l <- cbind(0,0,0,1,-1,0)
wald.test(b = coef(mylogit), Sigma = vcov(mylogit), L = l)
exp(coef(mylogit))
exp(cbind(OR = coef(mylogit), confint(mylogit)))
newdata1 <- with(mydata,data.frame(gre = mean(gre), gpa = mean(gpa), rank = factor(1:4)))
newdata1
newdata1$rankP <- predict(mylogit, newdata = newdata1, type = "response")
newdata1
round(newdata1,2)
newdata2 <- with(mydata,data.frame(gre = rep(seq(from = 200, to = 800, length.out = 100), 4),gpa = mean(gpa), rank = factor(rep(1:4, each = 100))))
newdata3 <- cbind(newdata2, predict(mylogit, newdata = newdata2, type="link", se=TRUE))
newdata3 <- within(newdata3, {PredictedProb <- plogis(fit) LL <- plogis(fit - (1.96 * se.fit)) UL <- plogis(fit + (1.96 * se.fit))})
newdata3 <- within(newdata3, {
PredictedProb <- plogis(fit)
LL <- plogis(fit - (1.96 * se.fit))
UL <- plogis(fit + (1.96 * se.fit))
})
head(newdata3)
ggplot(newdata3, aes(x = gre, y = PredictedProb)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = rank), alpha = .2) +
geom_line(aes(colour = rank), size=1)
ggplot(newdata3, aes(x = gre, y = PredictedProb)) +
geom_ribbon(aes(ymin = LL, ymax = UL, fill = rank), alpha = .2) +
geom_line(aes(colour = rank), size=1)
with(mylogit, null.deviance - deviance)
with(mylogit, df.null - df.residual)
with(mylogit, pchisq(null.deviance - deviance, df.null - df.residual, lower.tail = FALSE))
logLik(mylogit)
setwd("/home/ben/Documentos/ben/Documentos/OPI/2.A/Files")
files = list.files(pattern="*.csv")
ecobici = do.call(rbind, lapply(files, function(x) read.csv(x,sep = ";",stringsAsFactors = FALSE)))
ecobici2<-ecobici
ecobici2$Fecha_Retiro<-as.Date(ecobici2$Fecha_Retiro,format = '%d/%m/%Y')
ecobici2$Fecha_Arribo<-as.Date(ecobici2$Fecha_Arribo,format = '%d/%m/%Y')
ecobici2$Genero_Usuario<-factor(ecobici2$Genero_Usuario)
ecobici2$Fecha_Retiro<-factor(ecobici2$Fecha_Retiro)
ecobici2$Hora_Retiro<-factor(ecobici2$Hora_Retiro)
ecobici2<-ecobici
ecobici2$Fecha_Retiro<-as.Date(ecobici2$Fecha_Retiro,format = '%d/%m/%Y')
ecobici2$Fecha_Arribo<-as.Date(ecobici2$Fecha_Arribo,format = '%d/%m/%Y')
ecobici2$Genero_Usuario<-factor(ecobici2$Genero_Usuario)
ecobici2$Fecha_Retiro<-factor(ecobici2$Fecha_Retiro)
ecobici2$Ciclo_Estacion_Retiro<-factor(ecobici2$Ciclo_Estacion_Retiro)
ecobici2$Ciclo_Estacion_Arribo<-factor(ecobici2$Ciclo_Estacion_Arribo)
ecobici2$Hora_Arribo<-factor(ecobici2$Hora_Arribo)
afluencia2<-table(estaciones=ecobici2$Ciclo_Estacion_Retiro, Horario=ecobici2$Hora_Retiro)
prin<-sort(afluencia2[,c(8:10,14:16,18:20)],decreasing = TRUE)
head(prin)
prin<-sort(afluencia2[,c(8:10,14:16,18:20)],decreasing = TRUE)
rm(prin)
head(afluencia2)
pr<-data.frame(afluencia2,check.names = TRUE)
head(pr)
length(pr)
dim(pr)
tail(pr)
pr<-sort(pr[,3],decreasing = TRUE)
head(pr,50)
max.col(afluencia2)
max.row(afluencia2)
rm(pr)
pr<-as.data.frame(afluencia2)
str(pr)
table(pr$estaciones,pr$Horario)
rm(pr)
hmod<-hclust(afluencia2)
write.csv(afluencia2,"afluencia.csv")
afluencia<-read.csv("afluencia.csv",header = TRUE,row.names = 1)
head(afluencia[,order(c(8:10,14:16,18:20))],20)
str(afluencia)
head(afluencia2,10)
names(afluencia)[1:21]<-c("H0","H5","H6","H7","H8","H9","H10","H11","H12","H13","H14","H15","H16","H17","H18","H19","H20","H21","H22","H23")
str(afluenc)
str(afluencia)
names(afluencia)[1:21]<-c("H0","H1","H5","H6","H7","H8","H9","H10","H11","H12","H13","H14","H15","H16","H17","H18","H19","H20","H21","H22","H23")
str(afluencia)
resul<-sort(afluencia[,c(6:8,12:14,16:18)],decreasing = TRUE)
resul<-sort(afluencia[,c(6:8)],decreasing = TRUE)
resul<-sort(afluencia[,c(6)],decreasing = TRUE)
resul<-sort(afluencia[,c(6,7,8)],decreasing = TRUE)
rm(result)
rm(resul)
head(afluencia[,order(,c(afluencia$H7,afluencia$H8))],10)
head(afluencia[,order(,c(4,5))],10)
head(afluencia[,order(c(4,5))],10)
str(afluencia)
hmodel<-hclust(afluencia)
hmodel<-hclust(afluencia,method = "complete")
hmodel<-hclust(dist(afluencia[2:21]),method = "complete")
hmodel
summary(hmodel)
plot(hmodel)
hmodel<-hclust(scale(dist(afluencia[2:21])),method = "complete")
hmodel<-hclust(dist(scale(afluencia[,2:21])),method = "complete")
plot(hmodel)
plot(as.phylo(hmodel), type="phylogram", cex = .5, label.offset = .1,tip.col = c(rep("red", 50), rep("blue", 50), rep("green",50)))
plot(hmodel,xlab = "", sub = "", main = "", ylab = "",yaxt = "n")
hm<-dist(scale(afluencia[1:50,2:21]))
hmodel<-hclust(hm,method = "complete")
plot(hmodel,xlab = "", sub = "", main = "", ylab = "",yaxt = "n")
hm<-dist(scale(afluencia[1:100,2:21]))
hmodel<-hclust(hm,method = "complete")
plot(hmodel,xlab = "", sub = "", main = "", ylab = "",yaxt = "n")
estaciones<-rowMeans(afluencia)
estaciones<-sort(estaciones,decreasing = TRUE)
head(estaciones,50)
summary(estaciones)
clasificacion<-ifelse(estaciones<1242 & estaciones>320, "Muy alto",ifelse(estaciones<=320 & estaciones>238,"Alto",ifelse(estaciones<=238 & estaciones>190,"Media",ifelse(estaciones<=190 & estaciones>180,"Bajo","Muy Bajo"))))
pie(table(clasificacion))
ODMatrix2<-table(origen=ecobici2$Ciclo_Estacion_Retiro,destino=ecobici2$Ciclo_Estacion_Arribo)
ODMatrix2
hm<-dist(scale(afluencia[,2:21]))
hmodel<-hclust(hm,method = "complete")
plot(hmodel,xlab = "", sub = "", main = "", ylab = "",yaxt = "n")
hm2<-dist(scale(afluencia[,2:21]),method = "manhatan")
hm2<-dist(scale(afluencia[,2:21]),method = "manhattan")
hmodel2<-hclust(hm,method = "complete")
plot(hmodel2,xlab = "", sub = "", main = "", ylab = "",yaxt = "n")
plot(hmodel2,xlab = "", sub = "", main = "", ylab = "",yaxt = "n")
hm2<-dist(afluencia[,2:21],method = "manhattan")
hmodel2<-hclust(hm,method = "complete")
plot(hmodel2,xlab = "", sub = "", main = "", ylab = "",yaxt = "n")
plot(hmodel,xlab = "", sub = "", main = "", ylab = "",yaxt = "n")
kmodel<-kmeans(afluencia[,2:21],5,iter.max = 100)
kmodel
kmodel<-kmeans(afluencia[,2:21],6,iter.max = 100)
kmodel
kmodel<-kmeans(afluencia[,2:21],4,iter.max = 100)
kmodel
hm<-dist(scale(afluencia))
hmodel<-hclust(hm,method = "complete")
plot(hmodel,xlab = "", sub = "", main = "", ylab = "",yaxt = "n")
hm2<-dist(afluencia[,2:21],method = "manhattan")
hmodel2<-hclust(hm,method = "complete")
plot(hmodel2,xlab = "", sub = "", main = "", ylab = "",yaxt = "n")
kmodel<-kmeans(afluencia,6,iter.max = 100)
kmodel
str(afluencia)
require(graphics,stats)
kmodel<-kmeans(afluencia,6,iter.max = 100)
kmodel
plot(afluencia[,c(6,7)], xlab = "8 horas", ylab = "9 horas", pch = 16, col = cl$clust, cex = 2.5)
text(afluencia[,6], afluencia[ ,7], labels = row.names(afluencia), pos = 2)
plot(afluencia[,c(6,7)], xlab = "8 horas", ylab = "9 horas", pch = 16, col = kmodel$clust, cex = 2.5)
text(afluencia[,6], afluencia[ ,7], labels = row.names(afluencia), pos = 2)
plot(afluencia[,c(6,7)], xlab = "8 horas", ylab = "9 horas", pch = 16, col = kmodel$clust, cex = 2.5)
kmodel<-kmeans(afluencia,2,iter.max = 100)
kmodel
plot(afluencia[,c(6,7)], xlab = "8 horas", ylab = "9 horas", pch = 16, col = kmodel$clust, cex = 2.5)
text(afluencia[,6], afluencia[ ,7], labels = row.names(afluencia), pos = 2)
plot(afluencia[,c(6,7)], xlab = "8 horas", ylab = "9 horas", pch = 16, col = kmodel$clust, cex = 2.5)
kmodel<-kmeans(afluencia,3,iter.max = 100)
kmodel
plot(afluencia[,c(6,7)], xlab = "8 horas", ylab = "9 horas", pch = 16, col = kmodel$clust, cex = 2.5)
str(afluencia)
kmodel<-kmeans(afluencia,5,iter.max = 100)
kmodel
plot(afluencia[,c(12,13)], xlab = "Afluencia a las 14 horas", ylab = "Afluencia a las 15 horas", pch = 16, col = kmodel$clust, cex = 2.5)
kmodel<-kmeans(afluencia,6,iter.max = 100)
kmodel
plot(afluencia[,c(12,13)], xlab = "Afluencia a las 14 horas", ylab = "Afluencia a las 15 horas", pch = 16, col = kmodel$clust, cex = 2.5)
kmodel<-kmeans(afluencia,7,iter.max = 100)
kmodel
plot(afluencia[,c(12,13)], xlab = "Afluencia a las 14 horas", ylab = "Afluencia a las 15 horas", pch = 16, col = kmodel$clust, cex = 2.5)
kmodel<-kmeans(afluencia,6,iter.max = 100)
kmodel
plot(afluencia[,c(12,13)], xlab = "Afluencia a las 14 horas", ylab = "Afluencia a las 15 horas",main="Con 6-klusters" ,pch = 16, col = kmodel$clust, cex = 2.5)
pairs(afluencia[1:10,c(6:8,12:14,16:18)],col=kmodel$cluster)
pairs(afluencia[,c(6:8,12:14,16:18)],col=kmodel$cluster)
plot(hmodel2,xlab = "", sub = "", main = "", ylab = "",yaxt = "n", col=kmodel$cluster)
cor(afluencia)
d1<-dist(afluenia)
d1<-dist(afluencia)
d1
rm(d1)
setwd("/home/ben/Documentos/ben/Documentos/OPI/Problemas Resuelts/Nacimientos")
setwd("/home/ben/Documentos/ben/Documentos/OPI/Problemas resueltos/Nacimientos")
nacimientos<-read.csv("nacimiento.csv", header = TRUE, sep = ",", row.names = 1, stringsAsFactors = FALSE)
nacimientos<-read.csv("nacimiento.csv", header = TRUE, sep = ",", row.names = 1, stringsAsFactors = FALSE)
plot(nacimientos$ID,nacimientos$o.1.años,col=3,pch=18, xlab ="años",ylab = "nacimientos")
axis(1,at=1:5, labels = c("1990","1995","2000","2005","2010"))
modelo<-lm(o.1.años~ID,data=nacimientos)
summary(modelo)
abline(modelo,col=2)
fit<-predict(modelo,data.frame(ID=6.2))
predict(modelo,data.frame(ID=6.2),interval = "confidence")
resultado<-fit*.5126
round(resultado,0)
plot(nacimientos$ID,nacimientos$o.1.años,col=3,pch=18, xlab ="años",ylab = "nacimientos")
axis(1,at=1:5, labels = c("1990","1995","2000","2005","2010"))
modelo<-lm(o.1.años~ID,data=nacimientos)
summary(modelo)
abline(modelo,col=2)
fit<-predict(modelo,data.frame(ID=6.2))
#BORRAR TODAS LAS VARIABLES
rm(list=ls(all=TRUE))
setwd("/home/ben/Documentos/ben/Documentos/OPI/Problemas resueltos/Nacimientos")
nacimientos<-read.csv("nacimiento.csv", header = TRUE, sep = ",", row.names = 1, stringsAsFactors = FALSE)
plot(nacimientos$ID,nacimientos$o.1.años,col=3,pch=18, xlab ="años",ylab = "nacimientos")
axis(1,at=1:5, labels = c("1990","1995","2000","2005","2010"))
modelo<-lm(o.1.años~ID,data=nacimientos)
summary(modelo)
abline(modelo,col=2)
plot(nacimientos$ID,nacimientos$o.1.años,col=3,pch=18, xlab ="años",ylab = "nacimientos", main="Bebes menores a 1 año en GAM")
axis(1,at=1:5, labels = c("1990","1995","2000","2005","2010"))
abline(modelo,col=2)
setwd("/home/ben/Documentos/ben/Documentos/OPI/Problemas resueltos/Nacimientos")
nacimientos<-read.csv("nacimiento.csv", header = TRUE, sep = ",", row.names = 1, stringsAsFactors = FALSE)
plot(nacimientos$ID,nacimientos$o.1.años,col=3,pch=18, xlab ="años",ylab = "nacimientos", main="Bebes menores a 1 año en GAM")
axis(1,at=1:5, labels = c("1990","1995","2000","2005","2010"))
modelo<-lm(o.1.años~ID,data=nacimientos)
summary(modelo)
abline(modelo,col=2)
